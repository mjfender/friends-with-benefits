<p> <%= flash[:notice] %> </p>

<p>Posted in: <%= render partial: 'shared/group_title', collection: @need.groups, as: :group %></p>

<h1> <%= @need.headline %> </h1>
<h3> by: <%= link_to @need.user.name, user_path(@need.user) %><%= " (That's you!)" if need_belongs_to_user? %></h3>

<%= button_to "Edit Your Post", edit_need_path(@need), action: "get", method: "get" if need_belongs_to_user? %>

<% if @need.description %>
  <h2><%= @need.user.display_name(@user) %> said...</h2>
  <p> <%= @need.description %></p>
<% end %>



<% if @need.expiration %>
<h2> Expiring on:</h2>
<%= need_expiration_formatted %><br><br>
<% end %>

<br>
<%= button_to "All Needs", needs_path, action: "get", method: "get"%>

<%= button_to "Reply", new_reply_path, action: "get", method: "get", params: {need_id: @need.id} %>

<h2>Replies</h2>
<ul>
<% if @replies.empty? %>
  <p> Nobody has replied yet. Share your need and stay tuned! </p>
<% else %>
<% @replies.each do |reply| %>
  <% if !reply.comment.nil? && !reply.comment.empty? %>
  <li>"<%= reply.comment %>" &mdash; <%= link_to reply.user.name, user_path(reply.user) %><br>
  <% if reply.yes %><strong>(Yes, I want to help!)</strong><% end %> </li>
  <% else %>
  <li>   <strong>Yes, I want to help!</strong> &mdash; <%= link_to reply.user.name, user_path(reply.user) %></li>
  <% end %>
  <br> <% if current_user == reply.user.id %>
  <%= button_to "Edit", edit_reply_path(reply) %> 
  <%= button_to "Delete", delete_reply_path(reply), method: :delete  %><br><br>



  <% end %>

<% end %>
<% end %>
</ul>

<h2> Event Details </h2>

<% unless @need.events.blank? %>
  <p><%= link_to "Check out the event at #{@need.events.first.time_formatted}", need_event_path(@need, @need.events.first) %></p>
<% end %>

<% if @user == @need.user && @need.events.blank? %>
  <p><%= link_to "Ready to create an event?", new_need_event_path(@need) %></p>
<% elsif @user != @need.user && @need.events.blank? %>
  <p> There are no events created yet! </p>
<% end %>



<!-- Total number of replies, deadline -->
<!-- Add list of replies with their users-->
